---
title: "PEPA"
subtitle: "Pensamiento Estad√≠stico en People Analytics"
author: "Arturo De Zan | Sergio Garcia Mora"
output: learnr::tutorial
runtime: shiny_prerendered
---

```{r setup, include=FALSE}
library(learnr)
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
```

# PEPA

![](https://youtu.be/Mz4GbMCqvcY){width="80%"}

Este es un tutorial interactivo que dise√±amos para simplificar la pr√°ctica y afirmar los conocimientos vistos en las clases de **PEPA** (**P**enstamiento **E**stad√≠stico en **P**eople **A**nalytics) y pensado para simplificar lo m√°s posible los ejercicios sin que requiera tanto de vos escribiendo c√≥digo.

Los scripts que usaremos en este documento los pod√©s copiar y pegar para reutilizarlos en tu propia PC. Record√° que ten√©s estos recursos a disposici√≥n:

-   [Mapa conceptual](https://miro.com/app/board/o9J_l_mwKFM=/) de R y RStudio con sus respectivos videos explicativos.
-   [Tutorial interactivo de Introducci√≥n a R](https://chechoid.shinyapps.io/clase_1_introduccion_r_y_tidyverse/)
-   Todo el material del [Club de R para RRHH](https://drive.google.com/drive/folders/1Qck3z_t6XLRXb2vbN-00931DgdJZ0yse?usp=sharing) en Google Drive. Cada carpeta de cada mes, tiene un link a su respectivo video en Youtube. Y ac√° hay contenido introductorio, hasta cosas m√°s complejas como an√°lisis predictivos, text mining o an√°lisis de clusters por ejemplo.

### ¬øC√≥mo usar este tutorial?

Este tutorial va a tener distintas secciones, en las cuales vas a poder correr los resultados directamente aprentando el √≠cono que dice **"Run Code"**.

Por ejemplo, prob√° sumar 2 + 2 y hacer click en **"Run Code"**.

```{r two-plus-two, exercise=TRUE}

```

El c√≥digo tambi√©n corre con las teclas *Ctrl+Enter.*

En cada ejercicio vas a poder encontrar pistas en la tecla **"Hint"**. Calcul√° tu edad en el siguiente script:

```{r edad, exercise=TRUE, exercise.lines = 9}
# Pon√© el a√±o en el que naciste
anio_nacimiento <- ____
anio_actual <- 2021

# Calcul√° tu edad
edad <- _______ - ________

# Visualiz√° los resultados
edad
```

```{r edad-hint-1}
# Reemplaz√° las l√≠neas ____ por el a√±o en el que naciste
# Para calcular tu edad rest√° el a√±o actual menos tu a√±o de nacimiento
```

```{r edad-hint-2}
# Pon√© el a√±o en el que naciste
anio_nacimiento <- 1979
anio_actual <- 2021

# Calcul√° tu edad
edad <- anio_actual - anio_nacimiento

# Visualiz√° los resultados
edad
```

Para este tutorial vamos a utilizar el dataset de la **Encuesta KIWI de Sueldos LATAM** ü•ù que est√°n almacenados en un objeto .`RDS` que es una extensi√≥n propia de R para almacenar datos y que mantiene las caracter√≠sticas de los datos. Tambi√©n hay una versi√≥n `.csv` en el [repositorio de esta clase](https://raw.githubusercontent.com/chechoid/dpa-itba/main/PEPA/kiwi_ar.csv).

```{r carga-datos, echo=TRUE}
# Cargamos los datos
kiwi_ar <- readRDS("kiwi_ar.RDS")
```

### Explorando los datos

Corr√© la siguiente l√≠nea de c√≥digo y respond√© la pregunta a continuaci√≥n

```{r str, exercise=TRUE}
# Ver la estructura del data frame
str(kiwi_ar)
```

```{r str-q, }
quiz(
  question("¬øCu√°ntas filas y columnas tiene el dataframe 'salarios'?",
  answer("548 columnas y 43 variables", message = "Las observaciones son las filas y las variables son las columnas"),
  answer("548 variables y 43 filas", message = "Mir√° de nuevo el resultado de la estructura del dataframe salarios. Primero indica las observaciones, y luego las variables"),
  answer("548 filas y 43 columnas", correct = TRUE, message = "Muy bien!"),
  submit_button = "Enviar respuesta",
  try_again_button = "Intenta de nuevo",
  allow_retry = TRUE
))
```

# An√°lisis Univariado

Con el **an√°lisis univariado** lo que hacemos es analizar una variable a la vez. Dependiendo si la variable es *categ√≥rica* o *num√©rica* vamos a poder realizar distintas c√°lculos y an√°lisis.

```{r librerias}
library(tidyverse)
library(funModeling)
library(summarytools)
library(scales)
```

## Trabajando con variables categ√≥ricas

Con las variables *categ√≥ricas,* ya sean *nominales* u *ordinales*, no podemos hacer calculos aritm√©ticos como sumas, promedios y cosas por el estilo. ¬øQu√© podemos hacer? Por ejemplo contar casos.

```{r cate-1, exercise=TRUE}
library(tidyverse) # Limpieza y manipulaci√≥n de datos

kiwi_ar %>% 
  count(puesto) # Cuenta la cantidad de casos por puesto
```

Contar casos de una variable, como en el ejemplo anterior que contamos la cantidad de respuestas recibidas para cada puesto, en estad√≠stica se llama **Distribuci√≥n de Frecuencias**. ¬øPor qu√©?

![](https://cdn.memegenerator.es/imagenes/memes/full/29/80/29808033.jpg){width="300"}

En realidad, debe haber un por qu√©, pero podremos sobrevivir sin saberlo.

En ocasiones, algo que permite hacer m√°s claras las interpretaciones de los resultados es agregar los porcentajes.

```{r cate-2, exercise=TRUE}
# Tidyverse ya est√° cargado

# Hace click en "Run Code"
kiwi_ar %>% 
  count(puesto) %>% 
  mutate(porcentaje = percent(n / sum(n))) # Toma el valor de la celda en n y lo divide por el total de la columna n
```

Al incorporar el porcentaje en el an√°lisis lo que estamos haciendo es agregar, lo que en estad√≠stica se llama **Frecuencias Relativas.**

En el data frame tenemos entonces tres posiciones, `Administrativo`, `Analista`, y `HRBP` que no son posiciones jer√°rquicas. ¬øQu√© porcentaje del total representan?

Dados que los datos est√°n ordenados por jerarqu√≠a (¬øc√≥mo se llaman estas variables?) podemos sumar el porcentaje de `Administrativo` al porcentaje de `Analista`, y ese total, sumarlo a `HRBP`. Usemos la funci√≥n `freq()` del paquete `summarytools` para hacerlo f√°cilmente.

```{r cate-3, exercise = TRUE}

kiwi_ar %>% 
  select(puesto) %>% 
  freq(report.nas = FALSE)
```

Si vamos sumando los porcentajes de cada fila, *acumul√°ndolos* (agregando primero `Administrativo` y `Analista` y siguiendo despu√©s con `HRBP` y as√≠ sucesivamente) lo que estamos haciendo es una **Distribuci√≥n de Frecuencias Relativas Acumuladas**.

Entonces, ¬øqu√© porcentaje de las respuestas pertenecen a personas en puestos no jer√°rquicos?

```{r cate-4}
quiz(
  question("¬øQu√© porcentaje de las respuestas son de personas en posiciones no jer√°rquicas (considerando Administrativos, Analistas y HRBP)?",
           answer("10.40%", message = "Ese es el porcentaje de los HRBP"),
           answer("56.39%", message = "Excelente!", correct = T),
           answer("45.99%", message = "Esa es el porcentaje acumulado de Administrativo y Analista. Falta sumar el porcentaje de los HRBP."),
           submit_button = "Enviar respuesta",
           try_again_button = "Intenta de nuevo",
           allow_retry = TRUE
))
```

### Repaso

-   **Distribuci√≥n de frecuencias:** Que es el conteo de ingresos por trimestre.

-   **Frecuencias relativas:** Que es el *porcentaje* que representa el conteo sobre el total.

-   **Frecuencia relativas acumuladas:** Que representa el *porcentaje acumulado* de los ingresos de cada trimestre.

### A practicar!

¬øSe puede tomar mate en todas las empresas? Veamos la cantidad de respuestas de la variable `mate` para ver en cu√°ntos casos respondieron que s√≠ se pod√≠a tomar, y cu√°ntos respondieron que no. Reemplaz√° los espacios vac√≠os seg√∫n corresponda al nombre de la funci√≥n o de la variable.

```{r cate-5}
kiwi_ar %>% 
  count(_____)
```

```{r cate-5-hint-1}
# Reemplaz√° el espacio vac√≠o dentro de la funci√≥n count() con el nombre de la variable 'mate'
```

```{r cate-5-hint-2}
kiwi_ar %>% 
  count(mate)
```

¬øY qu√© porcentaje representan de las respuestas? Agrega una columna calculando el porcentaje (frecuencia relativa).

```{r cate-6, exercise=TRUE, exercise.lines = 5}
kiwi_ar %>% 
  ______(____) %>% # Complet√° con la funci√≥n y la variable que corresponde
  mutate(porcentaje = n/sum(n)) # Agrega una columna con los porcentajes.
```

```{r cate-6-hint-1}
# Us√° la funci√≥n count() para contar la cantidad de respuestas por cada caso
# La variable que queremos analizar se llama 'mate'
```

```{r cate-6-hint-2}
kiwi_ar %>% 
  count(mate) %>% # Complet√° con la funci√≥n y la variable que corresponde
  mutate(porcentaje = n/sum(n)) # Agrega una columna con los porcentajes.
```

Calcular la distribuci√≥n de frecuencias acumuladas seg√∫n la `region`. Reemplaz√° los espacios vac√≠os seg√∫n corresponda al nombre de la funci√≥n o de la variable.

```{r cate-7, exercise=TRUE, exercise.lines = 4}
kiwi_ar %>% 
  count(______)
```

```{r cate-7-hint-1}
# Reemplaz√° el espacio vac√≠o dentro de la funci√≥n count() con el nombre de la variable 'region'
```

```{r cate-7-hint-2}
kiwi_ar %>% 
  select(region) %>% 
  freq(report.nas = FALSE)
```
