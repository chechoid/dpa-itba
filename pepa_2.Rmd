---
title: "PEPA D칤a 1 - Clase 2"
author: "Arturo De Zan | Sergio Garcia Mora"
date: "11/6/2021"
output: 
  html_document:
    theme: spacelab
    highlight: textmate
    toc: true
    toc_float: true
    code_download: true
    code_folding: show
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
options(scipen = 999)
```

# Estad칤stica para gente anal칤tica

Recuerden que para utilizar el c칩digo de este documento html pueden copiar y pegar el c칩digo, o crear directamente un script descargando el archivo en la carpeta del proyecto, y en la consola de R escribir:

```{r extraer-script, eval=FALSE}
knitr::purl("pepa_2.Rmd")
```

En esta clase vamos a trabajar con los siguientes paquetes:

```{r librerias}
library(readxl)       # Carga de archivos de Excel
library(tidyverse)    # Carga, limpieza, transformaci칩n y visualizaci칩n de datos
library(funModeling)  # An치lisis Exploratorio de Datos
library(lubridate)    # Trabajar con fechas
```

Nuevamente, utilizaremos las mismas fuentes de datos que en el m칩dulo anterior:

```{r datos}
plantel <- read_excel("datos/plantel.xlsx")
kiwi <- read_csv("datos/kiwi_rh.csv")
```

```{r cleaning}
plantel <- plantel %>% 
  mutate(anio_ingreso = floor_date(fecha_ingreso,
                                   unit = "year"),  # Extrae el a침o de la fecha ingreso
         q_ingreso = quarter(fecha_ingreso))  # Columna nueva con el trimestre


# Creamos una nueva columna uniendo las nuevas columnas que acabamos de crear
plantel$anioq_ingreso <- paste(plantel$anio_ingreso, plantel$q_ingreso, sep = "-")


# Creamos una columna con las generaciones a la que pertenecen los empleados
# Fuente: https://www.mckinsey.com/industries/consumer-packaged-goods/our-insights/true-gen-generation-z-and-its-implications-for-companies#
plantel <- plantel %>% 
  mutate(anio_nacimiento = year(fecha_nacimiento),
         generacion = case_when(
           anio_nacimiento <= 1959 ~ "Baby Boomer",
           anio_nacimiento <= 1979 ~ "Gen X",
           anio_nacimiento <= 1994 ~ "Gen Y",
           anio_nacimiento = TRUE  ~ "Gen Z"
  )) %>% 
  select(-anio_nacimiento) # Elimina la columna anio_nacimiento
```

## Poblaci칩n y muestra

Por ejemplo, los datos del data frame `plantel` corresponden a un listado de empleados de una empresa. La **poblaci칩n** de empleados es `r nrow(plantel)`. Una **muestra**de los empleados podr칤a ser:

-   *Las personas en el Nivel de Contribuci칩n Operativo*

-   *El conjunto de mujeres en posiciones de liderazgo*

-   *Las personas de la Generaci칩n X*

```{r muestras}
# Ejemplo 1
plantel %>% 
  filter(nivel_contribucion == "Operativo") %>% 
  count()

# Ejemplo 2
plantel %>% 
  filter(nivel_contribucion %in% c("L칤der Equipo", "Gerencia", "Direcci칩n"),
         sexo == "Femenino") %>% 
  count(nivel_contribucion)

# Ejemplo 3
plantel %>% 
  filter(generacion == "Gen X") %>% 
  count()
```

# Medidas de Posici칩n

## Promedio

![](https://i.ytimg.com/vi/NLt3gFeYX3c/hqdefault.jpg){width="347"}

El **promedio** es una medida de tendencia central 游뱚 con el que todas y todos estamos bastante familiarizadas y familiarizados. Es una m칠trica muy 칰til porque todo el que curs칩 una materia en el colegio sabe como se calcula, y qu칠 significa su resultado.

> El promedio es el valor m치s representativo de un conjunto de datos... (ponele)...

La funci칩n en R para calcular el promedio se llama `mean()`. Por ejemplo, calculemos la edad promedio de nuestro `plantel`.

```{r mean1}
promedio <- mean(plantel$edad)

promedio
```

El promedio de edad en esta empresa es `r promedio`. Una forma de representarlo visualmente es de la siguiente manera:

```{r mean2}
ggplot(plantel, aes(x = edad)) +
  geom_histogram() +
  geom_vline(xintercept = promedio, size = 1, color = "red")
```

Una propiedad que tiene el promedio es que la suma de las distancias de cada uno de los puntos al promedio es la m치s chica posible (o sea que si resto el valor de cada edad al promedio, para todos los casos, el resultado total es el m치s chico posible).

Veamos esto con un dataset m치s chico:

```{r edades}
# Cargamos el archivo
edades <- read_excel("datos/edades.xlsx")

# Graficamos la edad de cada participante
ggplot(edades, aes(x = Edad, y = Inicial, label = Inicial))+
  geom_point() + 
  labs(y="")+
  geom_text(nudge_x = 0.3, nudge_y = 0.3) +
  geom_vline(xintercept = mean(edades$Edad), color = "red", size = 1.2, alpha = 0.5)
```

## Mediana

> *Cada cosa en su lugar y un lugar para cada cosa*

![](https://i.blogs.es/a7f35e/1366_2000/1366_521.jpg){width="324"}

As칤 como el promedio es una medida de *tendencia central*, la **mediana** y los **cuartiles** son medidas **de orden**. Lo que hacen estas medidas es ordenar los datos de mayor a menor, y nos indican cu치l es el valor que est치 en:

-   El valor correspondiente al 25% de los datos: **Primer cuartil**

-   El valor correspondiente al 50% de los datos: La **mediana** (el **segundo cuartil**)

-   El valor correspondiente al 75% de los datos: **Tercer cuartil.**

Calculemos la mediana de `sueldo_bruto` de la Encuesta KIWI

```{r median1}
mediana <- median(kiwi$sueldo_bruto)

mediana
```

Ya exploraremos otras propiedades y caracter칤sticas del promedio y la mediana. Ahora vamos a ver otra medida, la **moda**.
